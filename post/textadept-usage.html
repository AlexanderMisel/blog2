<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Textadept使用心得</title>
<meta name="keywords" content="Textadept,Lua,编码,模式匹配,Win,字体" />
<link href="../css/han.css" rel="stylesheet">
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><h1><a name='header-n0' class='md-header-anchor '></a>Textadept使用心得</h1><p>前一篇博客里我向大家推荐了Textadept。这篇里我来谈谈我的Textadept使用心得。以方便大家日常使用Textadept。</p><p>我们知道Textadept是跨平台的，图形界面基于GTK+。不管是Lua也好，GTK+也好，用过的人相信都会觉得它们在Linux上跑得更顺。所以Textadept要想配好，在Win下要做的配置要比Linux多一点点。这些是由于Win下路径也好，文件也好，都喜欢用一种反人类的gbk系列编码。路径还要用反斜杠，如果消灭反斜杠的路径的话，编程将会编得多么容易啊（无端联想）。</p><h2><a name='header-n4' class='md-header-anchor '></a>增加编码</h2><p>刚刚提到了编码的问题，我就先说这一点。Textadept出于极简、效率之类的考虑，没有像一些其他编辑器那样，把所有可能的编码都列到它的表里。只列了一些拉丁语系常用的编码。对于常用UTF-8的Linux来说可能很久才会察觉，但是在Windows上经常会遇到其他编码。为了支持gbk编码，我们需要在<code>core/file_io.lua</code>的<code>io.encodings</code>里面加上gbk。加上之后你就会发现，打开gbk编码的文件不崩溃了。</p><h2><a name='header-n6' class='md-header-anchor '></a>更改字体</h2><p>在Linux下我们可能也体会不到，那就是在Win下中文很可能会显示不出来。既然编码对了，那么为啥还是显示不出来呢？原因就在于Textadept给代码使用的字体是直接拿的GTK+的默认monospace字体，在Win下可能就是Courier New，但是这就出事了，这个字体没有汉字。那为什么其他编辑器显示得Courier New好好的呢？原因是他们查了系统的后备字体，但Textadept因为极简，当然不肯查了，所以我们要手动配。最简单的方式就是直接在<code>~/.textadept/init.lua</code>里面第一行配主题的时候顺便配上一个中英文通吃的字体，比如文泉驿等宽微米黑，如下：</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="lua"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="lua"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">view</span>:<span class="cm-variable">set_theme</span>(<span class="cm-string">'light'</span>, {<span class="cm-variable">font</span> = <span class="cm-string">'WenQuanYi Micro Hei Mono'</span>})</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p>但是其实还有一个地方可能需要设置，那就是界面菜单的字体。Win下如果你看到的是宋体的菜单的话，那应该没有显示不出来的字符，不过很丑；如果你看到的是雅黑的话，你有一定可能会看到有些字符显示不出来，显示不出来的话，你可以按照我下面说的做。修改<code>share/themes/MS-Windows/gtk-2.0/gtkrc</code>文件，在最底下加这些</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="cpp"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="cpp"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">style</span> <span class="cm-string">"wqyfont"</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">font_name</span> <span class="cm-operator">=</span> <span class="cm-string">"WenQuanYi Micro Hei 10"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">widget</span> <span class="cm-string">"*"</span> <span class="cm-variable">style</span> <span class="cm-string">"wqyfont"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 110px;"></div><div class="CodeMirror-gutters" style="display: none; height: 110px;"></div></div></div></pre><h2><a name='header-n11' class='md-header-anchor '></a>引入模块</h2><p>你要用别人的扩展，或者自己写扩展，势必要引入模块的。绝对不要把所有代码都写到一个init.lua里面。Lua引入模块的方式很简单：</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="lua"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="lua"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">_M.file_browser</span> = <span class="cm-builtin">require</span>(<span class="cm-string">'file_browser'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p>简单地require一下就好了。有人说Lua像JavaScript，我也这么觉得。一些JavaScript编程的感觉都可以借鉴过来。未避免大家重复造轮子，这个<a href='https://foicica.com/wiki/textadept'>Wiki</a>你们是一定要看的。最好还要订阅一下Textadept的邮件列表。Mitchell还是一个很热心的人的，基本上我问的问题他都解答了。</p><p>语言模块相信是大家用得最多的。它为大家提供的是语言的自动补全、快捷键以及片段（snippets）等。除了这些，我还用到的有folding（代码折叠）、File Browser（文件浏览器）等。</p><h2><a name='header-n16' class='md-header-anchor '></a>模式匹配</h2><p>如果你没用过Lua的话，我觉得可能最让你陌生的就是Lua的模式匹配了吧。Textadept很奇葩地在不同地方用了三种不同的模式匹配方案。当然你如果抱着学习的态度的话，对你更多的可能是帮助吧。下面我来说说这三种模式匹配：</p><ul><li>Lua原生的模式匹配。大部分地方作者都是用的这套方案。常见的匹配没问题的，就是和常用的正则表达式有比较大区别，但总体上语法还是类似的。如果不熟悉可以看看<a href='https://cloudwu.github.io/lua53doc/manual.html#6.4.1'>官方文档</a>或者<a href='https://foicica.com/textadept/manual.html#Lua.Patterns'>Textadept的手册</a>。</li><li>LPeg。LPeg可以说是相当强大的，也会给你完全不一样的体验。我感觉LPeg用起来的灵活性比较好，有编程感。再Textadept中把LPeg用在了词法解析器（lexer）中。不过lexer数量蛮多的，难免有些lexer实现不是太好或者搞出来不太好看的，希望大家能够顺手改进。</li><li>EcmaScript风格的标准正则表达式。用于界面上的搜索、替换等。源码里面是通过调用Scintilla的搜索函数实现的。这也带来了一点弊端，Scintilla不允许匹配换行符（<code>\r</code>和<code>\n</code>）；其实原来Textadept也是使用Lua模式匹配搜索的，但是新版本换掉了，想用Lua模式匹配的可以考虑试试<a href='https://foicica.com/wiki/lua-pattern-find'>这个</a>。</li></ul><h2><a name='header-n25' class='md-header-anchor '></a>代码格式化</h2><p>缩进大小相关的转换可以不用任何外部工具解决。只要你使用的语言是设置好缩进的，比如2个空格缩进，你只要把4个空格的文件复制过来，自动就会变成2个空格。</p><p>更专业的格式化就需要借助外部工具了。我这里举两个简单的例子：json和html。由于python有现成的json模块，不用白不用，所以就借用过来了，不过我还是做了点改动</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">argparse</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">json</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">sys</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">reload</span>(<span class="cm-variable">sys</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sys</span>.<span class="cm-property">setdefaultencoding</span>(<span class="cm-string">'utf-8'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">main</span>():</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">prog</span> = <span class="cm-string">'python jsontool.py'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">description</span> = (<span class="cm-string">'A simple command line interface for json module '</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'to validate and pretty-print JSON objects.'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span> = <span class="cm-variable">argparse</span>.<span class="cm-property">ArgumentParser</span>(<span class="cm-variable">prog</span>=<span class="cm-variable">prog</span>, <span class="cm-variable">description</span>=<span class="cm-variable">description</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'infile'</span>, <span class="cm-variable">nargs</span>=<span class="cm-string">'?'</span>, <span class="cm-builtin">type</span>=<span class="cm-variable">argparse</span>.<span class="cm-property">FileType</span>(),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">help</span>=<span class="cm-string">'a JSON file to be validated or pretty-printed'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'outfile'</span>, <span class="cm-variable">nargs</span>=<span class="cm-string">'?'</span>, <span class="cm-builtin">type</span>=<span class="cm-variable">argparse</span>.<span class="cm-property">FileType</span>(<span class="cm-string">'w'</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">help</span>=<span class="cm-string">'write the output of infile to outfile'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'--sort-keys'</span>, <span class="cm-variable">action</span>=<span class="cm-string">'store_true'</span>, <span class="cm-variable">default</span>=<span class="cm-keyword">False</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">help</span>=<span class="cm-string">'sort the output of dictionaries alphabetically by key'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">options</span> = <span class="cm-variable">parser</span>.<span class="cm-property">parse_args</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">infile</span> = <span class="cm-variable">options</span>.<span class="cm-property">infile</span> <span class="cm-keyword">or</span> <span class="cm-variable">sys</span>.<span class="cm-property">stdin</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">outfile</span> = <span class="cm-variable">options</span>.<span class="cm-property">outfile</span> <span class="cm-keyword">or</span> <span class="cm-variable">sys</span>.<span class="cm-property">stdout</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">sort_keys</span> = <span class="cm-variable">options</span>.<span class="cm-property">sort_keys</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">with</span> <span class="cm-variable">infile</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">try</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">obj</span> = <span class="cm-variable">json</span>.<span class="cm-property">load</span>(<span class="cm-variable">infile</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">except</span> <span class="cm-variable">ValueError</span> <span class="cm-keyword">as</span> <span class="cm-variable">e</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">raise</span> <span class="cm-variable">SystemExit</span>(<span class="cm-variable">e</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">with</span> <span class="cm-variable">outfile</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">json</span>.<span class="cm-property">dump</span>(<span class="cm-variable">obj</span>, <span class="cm-variable">outfile</span>, <span class="cm-variable">sort_keys</span>=<span class="cm-variable">sort_keys</span>, <span class="cm-variable">indent</span>=<span class="cm-number">2</span>, <span class="cm-variable">ensure_ascii</span>=<span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">outfile</span>.<span class="cm-property">write</span>(<span class="cm-string">'\n'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">__name__</span> == <span class="cm-string">'__main__'</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">main</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 792px;"></div><div class="CodeMirror-gutters" style="display: none; height: 792px;"></div></div></div></pre><p>改过之后其实在终端就可以了完成格式化了。但是想要再懒一点，在Textadept里面就完成操作的话，就需要Filter through功能了。我翻译界面文字的时候，不知道这个翻译成什么好，所以就保留了英文。使用Filter through功能也可以通过快捷键<kbd>Ctrl</kbd>+<kbd>|</kbd>完成，在下面的命令框输入</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python jsontool.py</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p>然后你就会看到完美格式化的JSON。其实我们的输入是通过stdin进去的，而我们会把它的stdout内容拿过来更新我们的文件。再比如HTML也同样，把我们需要的命令敲进去</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">tidy <span class="cm-attribute">-qi</span> <span class="cm-attribute">-w</span> <span class="cm-number">106</span> <span class="cm-attribute">--drop-empty-elements</span> <span class="cm-number">0</span> <span class="cm-attribute">--drop-empty-paras</span> <span class="cm-number">0</span> <span class="cm-attribute">--tidy-mark</span> <span class="cm-number">0</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p>就会得到格式化好的文件了。其他外部工具只要支持pipe输入输出的应该都没有问题。</p><h2><a name='header-n34' class='md-header-anchor '></a>仍然存在问题的地方</h2><p>Win下不能在打开其他文件的情况下打开一个有中文路径的文件。打开的话就会导致Textadept崩溃。目前原因尚不清楚。</p><h2><a name='header-n36' class='md-header-anchor '></a>总结</h2><p>总之，你要是用Textadept，你就不能期待一切帮你配好了。但是通过Textadept详细的API，实现很多功能都不那么困难了。<a href='../' title='返回首页'>∎</a></p></div>
</body>
</html>